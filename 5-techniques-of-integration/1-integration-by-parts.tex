\subsection{Integration by Parts}

\begin{theorem}[Integration by Parts Formula]
    If \(f\) and \(g\) are differentiable functions, then
    \[\int f(x)g'(x)\,dx=f(x)g(x)-\int g(x)f'(x)\,dx\]
    If \(u=f(x)\) and \(v=g(x)\), then
    \[\int u\,dv=uv-\int v\,du\]
    and
    \[\int_a^b u\,dv=[uv]_a^b-\int_a^b v\,du\]
\end{theorem}
\begin{proof}
    We know from the product rule that
    \[f(x)g(x)=\int f'(x)g(x)\,dx+\int f(x)g'(x)\,dx\]
    and therefore
    \[\int f(x)g'(x)\,dx=f(x)g(x)-\int g(x)f'(x)\,dx\]
\end{proof}
\begin{problem}
    Evaluate \(\displaystyle{\int\ln x\,dx}\).
\end{problem}
\begin{solution}
    Let \(u=\ln x\iff du=\dfrac{1}{x}\,dx\) and \(dv=dx\iff v=x\),
    then
    \[\int\ln x\,dx=x\ln x-\int dx=x\ln x-x+C\]
\end{solution}
\begin{problem}
    Evaluate \(\displaystyle{\int\arctan x\,dx}\).
\end{problem}
\begin{solution}
    Let \(u=\arctan x\iff du=\dfrac{dx}{1+x^2}\) and \(dv=dx\iff v=x\), then
    \[\int\arctan x\,dx=x\arctan x-\int\frac{x}{1+x^2}\,dx\]
    Let \(u=1+x^2\iff du=2x\,dx\) so \(x\,dx=\dfrac{1}{2}\,du\), then
    \[\int\frac{x}{1+x^2}\,dx=\frac{1}{2}\int\frac{du}{u}=\frac{1}{2}\ln|u|+C
    =\frac{1}{2}\ln(1+x^2)+C\]
    Therefore,
    \[\int\arctan x\,dx=x\arctan x-\frac{1}{2}\ln(1+x^2)+C\]
\end{solution}
\begin{problem}
    Evaluate \(\displaystyle{\int e^x\sin x\,dx}\).
\end{problem}
\begin{solution}
    Let \(u=\sin x\iff du=\cos x\,dx\) and \(dv=e^x\,dx\iff v=e^x\),
    then
    \[\int e^x\sin x\,dx=e^x\sin x-\int e^x\cos x\,dx\]
    Let \(u=\cos x\iff du=-\sin x\,dx\) and \(dv=e^x\,dx\iff v=e^x\),
    then
    \[\int e^x\cos x\,dx=e^x\cos x+\int e^x\sin x\,dx\]
    Therefore,
    \begin{align*}
        \int e^x\sin x\,dx &= e^x\sin x-e^x\cos x-\int e^x\sin x\,dx \\
        \int e^x\sin x\,dx &= \frac{1}{2}e^x(\sin x-\cos x) 
    \end{align*}
\end{solution}
\begin{problem}
    Prove the reduction formula
    \[\int\sin^n x\,dx
    =-\frac{1}{n}\sin^{n-1}x\cos x+\frac{n-1}{n}\int\sin^{n-2}x\,dx\]
    where \(n\in\N\) and \(n\geq 2\).
\end{problem}
\begin{solution}
    Let \(u=\sin^{n-1}x\iff du=(n-1)\sin^{n-2}x\cos x\,dx\) and
    \(dv=\sin x\,dx\iff v=-\cos x\) then
    \begin{align*}
        \int\sin^n x\,dx
        &= -\sin^{n-1}x\cos x+(n-1)\int \sin^{n-2}x\cos^2 x\,dx \\
        &= -\sin^{n-1}x\cos x+(n-1)\int \sin^{n-2}x(1-\sin^2 x)\,dx \\
        &= -\sin^{n-1}x\cos x+(n-1)\int \sin^{n-2}x\,dx-(n-1)\int\sin^n x\,dx
    \end{align*}
    Therefore
    \begin{align*}
        (n-1+1)\int\sin^n x\,dx=n\int\sin^n x\,dx
        &= -\sin^{n-1}x\cos x+(n-1)\int \sin^{n-2}x\,dx \\
        \int\sin^n x\,dx
        &= -\frac{1}{n}\sin^{n-1}x\cos x
        +\frac{n-1}{n}\int\sin^{n-2}x\,dx 
    \end{align*}
\end{solution}
\begin{problem}
    Prove the reduction formula
    \[\int\cos^n x\,dx
    =\frac{1}{n}\cos^{n-1}x\sin x+\frac{n-1}{n}\int\cos^{n-2}x\,dx\]
    where \(n\in\N\) and \(n\geq 2\).
\end{problem}
\begin{solution}
    Let \(u=\cos^{n-1}x\iff du=-(n-1)\cos^{n-2}x\sin x\,dx\) and
    \(dv=\cos x\,dx\iff v=\sin x\) then
    \begin{align*}
        \int\cos^n x\,dx
        &= \cos^{n-1} x\sin x+(n-1)\int\cos^{n-2}x\sin^2 x\,dx \\
        &= \cos^{n-1} x\sin x+(n-1)\int \cos^{n-2}x(1-\cos^2 x)\,dx \\
        &= \cos^{n-1} x\sin x+(n-1)\int \cos^{n-2}x\,dx-(n-1)\int\cos^n x\,dx
    \end{align*}
    Therefore
    \begin{align*}
        (n-1+1)\int\cos^n x\,dx=n\int\cos^n x\,dx
        &= \cos^{n-1}x\sin x+(n-1)\int \cos^{n-2}x\,dx \\
        \int\cos^n x\,dx
        &= \frac{1}{n}\cos^{n-1}x\sin x
        +\frac{n-1}{n}\int\cos^{n-2}x\,dx 
    \end{align*}
\end{solution}
\begin{problem}
    Show that
    \[\int_0^{\pi/2}\sin^n x\,dx=\frac{n-1}{n}\int_0^{\pi/2}\sin^{n-2}x\,dx\]
    where \(n\in\N\) and \(n\geq 2\).
\end{problem}
\begin{solution}
    We use the reduction formula then
    \begin{align*}
        \int_0^{\pi/2}\sin^n x\,dx
        &= \left[-\frac{1}{n}\sin^{n-1} x\cos x\right]_0^{\pi/2}
        +\frac{n-1}{n}\int_0^{\pi/2}\sin^{n-2} x\,dx \\
        &= -\frac{1}{n}\left(\sin^{n-1}\left(\frac{\pi}{2}\right)
        \cos\left(\frac{\pi}{2}\right)-\sin^{n-1}(0)\cos(0)\right)
        +\frac{n-1}{n}\int_0^{\pi/2}\sin^{n-2} x\,dx
    \end{align*}
    and since \(\sin(0)=0\) and \(\cos(\pi/2)=0\) so
    \[\int_0^{\pi/2}\sin^n x\,dx=-\frac{1}{n}(0)
    +\frac{n-1}{n}\int_0^{\pi/2}\sin^{n-2} x\,dx
    =\frac{n-1}{n}\int_0^{\pi/2}\sin^{n-2} x\,dx\]
\end{solution}
\begin{problem}
    Show that
    \[\int_0^{\pi/2}\sin^{2n+1} x\,dx
    =\frac{2\cdot4\cdot6\cdot\cdots\cdot2n}
    {3\cdot5\cdot7\cdot\cdots\cdot(2n+1)}\]
    where \(n\in\N\) and \(n\geq 2\).
\end{problem}
\begin{solution}
    By the reduction formula
    \begin{align*}
        \int_0^{\pi/2}\sin^{2n+1} x\,dx
        &= \frac{2n}{2n+1}\int_{0}^{\pi/2}\sin^{2n-1} x\,dx
        =\frac{(2n)(2n-2)}{(2n+1)(2n-1)}\int_{0}^{\pi/2}\sin^{2n-3} x\,dx \\
        &= \frac{(2n)(2n-2)\cdots(6)(4)(2)}{(2n+1)(2n-1)\cdots(7)(5)(3)}
        \int_{0}^{\pi/2}\sin x\,dx
    \end{align*}
    and since
    \[\int_{0}^{\pi/2}\sin x\,dx=\Big[-\cos x\Big]_0^{\pi/2}
    =-\cos\left(\frac{\pi}{2}\right)+\cos(0)=0+1=1\]
    hence
    \[\int_0^{\pi/2}\sin^{2n+1} x\,dx
    =\frac{2\cdot4\cdot6\cdot\cdots\cdot2n}
    {3\cdot5\cdot7\cdot\cdots\cdot(2n+1)}\]
\end{solution}
\begin{problem}
    Show that
    \[\int_0^{\pi/2}\sin^{2n} x\,dx
    =\frac{1\cdot3\cdot5\cdot\cdots\cdot(2n-1)}
    {2\cdot4\cdot6\cdot\cdots\cdot2n}\frac{\pi}{2}\]
    where \(n\in\N\) and \(n\geq 2\).
\end{problem}
\begin{solution}
    \begin{align*}
        \int_0^{\pi/2}\sin^{2n} x\,dx
        &= \frac{2n-1}{2n}\int_0^{\pi/2}\sin^{2n-2} x\,dx
        =\frac{(2n-1)(2n-3)}{(2n)(2n-2)}\int_0^{\pi/2}\sin^{2n-4} x\,dx \\
        &= \frac{(2n-1)(2n-3)\cdots(5)(3)(1)}{(2n)(2n-2)\cdots(6)(4)(2)}
        \int_0^{\pi/2}\,dx=\frac{1\cdot3\cdot5\cdot\cdots\cdot(2n-1)}
        {2\cdot4\cdot6\cdot\cdots\cdot2n}\frac{\pi}{2} 
    \end{align*}
\end{solution}
\begin{problem}
    Prove the reduction formula
    \[\int(\ln x)^n\,dx=x(\ln x)^n-n\int(\ln x)^{n-1}\,dx\]
\end{problem}
\begin{solution}
    Let \(u=(\ln x)^n\iff du=\dfrac{n}{x}(\ln x)^{n-1}\) and \(dv=dx\iff v=x\)
    then
    \[\int(\ln x)^n\,dx=x(\ln x)^n-\int x\cdot\frac{n}{x}(\ln x)^{n-1}\,dx
    =x(\ln x)^n-n\int(\ln x)^{n-1}\,dx\]
\end{solution}
\begin{problem}
    Prove the reduction formula
    \[\int x^n e^x\,dx=x^n e^x-n\int x^{n-1}e^x\,dx\]
\end{problem}
\begin{solution}
    Let \(u=x^n\iff du=nx^{n-1}\,dx\) and \(dv=e^x\,dx\iff v=e^x\) then
    \[\int x^n e^x\,dx=x^n e^x-\int nx^{n-1}e^x\,dx
    =x^n e^x-n\int x^{n-1}e^x\,dx\]
\end{solution}